<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solchi - Gaming AI Assistant</title>
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 0, 128, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(128, 0, 255, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 50%, #2d1b3d 100%);
            z-index: -2;
        }

        .particle-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: linear-gradient(45deg, #ff0080, #00ffff);
            border-radius: 50%;
            animation: float 20s infinite linear;
            opacity: 0.7;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0px);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        .main-container {
            display: flex;
            height: 100vh;
            position: relative;
            backdrop-filter: blur(1px);
        }

        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            width: 280px;
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.95), rgba(40, 20, 60, 0.9));
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 0, 128, 0.3);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ff0080, #00ffff, transparent);
            animation: scanline 3s ease-in-out infinite;
        }

        @keyframes scanline {
            0%, 100% { opacity: 0; transform: translateX(-100%); }
            50% { opacity: 1; transform: translateX(100%); }
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid rgba(255, 0, 128, 0.2);
            text-align: center;
        }

        .sidebar-logo {
            width: 60px;
            height: 60px;
            margin: 0 auto 1rem;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff, #00ffff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            font-size: 1.5rem;
            color: #fff;
            position: relative;
            animation: logoGlow 2s ease-in-out infinite alternate;
        }

        .sidebar-logo::before {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 50%;
            padding: 3px;
            background: linear-gradient(45deg, #ff0080, #8000ff, #00ffff);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            animation: logoRotate 4s linear infinite;
        }

        @keyframes logoGlow {
            0% { box-shadow: 0 0 20px rgba(255, 0, 128, 0.5); }
            100% { box-shadow: 0 0 40px rgba(0, 255, 255, 0.8), 0 0 60px rgba(255, 0, 128, 0.3); }
        }

        @keyframes logoRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .sidebar-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            background: linear-gradient(45deg, #ff0080, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ë¡œê·¸ì¸/ì‚¬ìš©ì í”„ë¡œí•„ ì˜ì—­ */
        .user-section {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(255, 0, 128, 0.2);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #fff;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: #fff;
            margin-bottom: 0.2rem;
        }

        .user-email {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .login-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.2), rgba(128, 0, 255, 0.2));
            border: 1px solid rgba(255, 0, 128, 0.5);
            border-radius: 8px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .login-btn:hover {
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.3), rgba(128, 0, 255, 0.3));
            border-color: #ff0080;
            transform: translateY(-1px);
        }

        .logout-btn {
            width: 100%;
            padding: 0.6rem;
            background: linear-gradient(45deg, rgba(255, 0, 0, 0.2), rgba(200, 0, 0, 0.2));
            border: 1px solid rgba(255, 0, 0, 0.5);
            border-radius: 6px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: linear-gradient(45deg, rgba(255, 0, 0, 0.3), rgba(200, 0, 0, 0.3));
            border-color: #ff0000;
        }

        .new-chat-btn {
            margin: 1.5rem;
            padding: 1rem;
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.2), rgba(128, 0, 255, 0.2));
            border: 1px solid rgba(255, 0, 128, 0.5);
            border-radius: 12px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .new-chat-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .new-chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 0, 128, 0.4);
            border-color: #ff0080;
        }

        .new-chat-btn:hover::before {
            left: 100%;
        }

        .chat-list {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .chat-item {
            padding: 0.8rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            position: relative;
        }

        .chat-item:hover {
            background: rgba(255, 0, 128, 0.1);
            border-color: rgba(255, 0, 128, 0.3);
            transform: translateX(5px);
        }

        .chat-item.active {
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.2), rgba(0, 255, 255, 0.1));
            border-color: #ff0080;
        }

        .chat-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }

        .chat-preview {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* ë©”ì¸ ì±„íŒ… ì˜ì—­ */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* ë¡œë”© ìŠ¤í¬ë¦° */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #2d1b3d 50%, #1a0a2e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .loading-screen.hidden {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }

        .cinematic-logo {
            position: relative;
            margin-bottom: 3rem;
        }

        .main-logo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff, #00ffff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', monospace;
            font-size: 4rem;
            font-weight: 900;
            color: #fff;
            position: relative;
            animation: cinematicIntro 3s ease-in-out;
            box-shadow: 
                0 0 50px rgba(255, 0, 128, 0.6),
                0 0 100px rgba(0, 255, 255, 0.4),
                inset 0 0 50px rgba(255, 255, 255, 0.1);
        }

        .main-logo::before {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff, #00ffff);
            animation: cinematicRing 3s ease-in-out infinite;
            z-index: -1;
        }

        .main-logo::after {
            content: '';
            position: absolute;
            inset: -20px;
            border-radius: 50%;
            background: linear-gradient(45deg, transparent, rgba(255, 0, 128, 0.3), transparent);
            animation: cinematicPulse 2s ease-in-out infinite;
            z-index: -2;
        }

        @keyframes cinematicIntro {
            0% {
                transform: scale(0) rotate(180deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(90deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        @keyframes cinematicRing {
            0%, 100% {
                transform: scale(1) rotate(0deg);
                opacity: 0.8;
            }
            50% {
                transform: scale(1.1) rotate(180deg);
                opacity: 0.4;
            }
        }

        @keyframes cinematicPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.3;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.1;
            }
        }

        .cinematic-title {
            font-family: 'Orbitron', monospace;
            font-size: 3.5rem;
            font-weight: 900;
            text-align: center;
            background: linear-gradient(45deg, #ff0080, #8000ff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            animation: cinematicText 1s ease-out 2s forwards;
            text-shadow: 0 0 30px rgba(255, 0, 128, 0.5);
        }

        .cinematic-subtitle {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.2rem;
            font-weight: 300;
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 1rem;
            opacity: 0;
            animation: cinematicText 1s ease-out 2.5s forwards;
        }

        @keyframes cinematicText {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* í—¤ë” */
        .header {
            padding: 1.5rem 2rem;
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.9), rgba(40, 20, 60, 0.8));
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 0, 128, 0.3);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #ff0080, #00ffff, transparent);
            animation: headerGlow 2s ease-in-out infinite;
        }

        @keyframes headerGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 1rem;
            background: linear-gradient(45deg, #ff0080, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 900;
            color: #fff;
            animation: headerLogoRotate 3s linear infinite;
        }

        @keyframes headerLogoRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ì±„íŒ… ì»¨í…Œì´ë„ˆ */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            scroll-behavior: smooth;
            position: relative;
        }

        .message {
            margin-bottom: 2rem;
            display: flex;
            gap: 1.5rem;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            animation: messageSlideIn 0.5s ease-out;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2rem;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .message.user .message-avatar {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.4);
        }

        .message.assistant .message-avatar {
            background: linear-gradient(45deg, #ff0080, #8000ff);
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.4);
            animation: avatarPulse 2s ease-in-out infinite;
        }

        @keyframes avatarPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 128, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 0, 128, 0.8); }
        }

        .message-content {
            flex: 1;
            padding: 1.5rem 2rem;
            border-radius: 20px;
            line-height: 1.8;
            position: relative;
            font-size: 1rem;
            backdrop-filter: blur(10px);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 165, 0, 0.1));
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-bottom-right-radius: 8px;
        }

        .message.assistant .message-content {
            background: linear-gradient(135deg, rgba(255, 0, 128, 0.1), rgba(128, 0, 255, 0.1));
            border: 1px solid rgba(255, 0, 128, 0.3);
            border-bottom-left-radius: 8px;
        }

        /* ì½”ë“œë¸”ë¡ ìŠ¤íƒ€ì¼ */
        .code-block {
            margin: 1.5rem 0;
            border-radius: 12px;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.95), rgba(40, 20, 60, 0.9));
            border: 1px solid rgba(255, 0, 128, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(90deg, rgba(255, 0, 128, 0.2), rgba(128, 0, 255, 0.2));
            border-bottom: 1px solid rgba(255, 0, 128, 0.3);
        }

        .code-language {
            font-family: 'Orbitron', monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: #00ffff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .copy-btn {
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.3), rgba(128, 0, 255, 0.3));
            border: 1px solid rgba(255, 0, 128, 0.5);
            border-radius: 6px;
            padding: 0.4rem 0.8rem;
            color: #ffffff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.5), rgba(128, 0, 255, 0.5));
            border-color: #ff0080;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 0, 128, 0.3);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .run-btn {
            background: linear-gradient(45deg, rgba(0, 255, 128, 0.3), rgba(0, 200, 100, 0.3));
            border: 1px solid rgba(0, 255, 128, 0.5);
            border-radius: 6px;
            padding: 0.4rem 0.8rem;
            color: #ffffff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }

        .run-btn:hover {
            background: linear-gradient(45deg, rgba(0, 255, 128, 0.5), rgba(0, 200, 100, 0.5));
            border-color: #00ff80;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 255, 128, 0.3);
        }

        .run-btn:active {
            transform: translateY(0);
        }

        .code-output {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 128, 0.3);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #00ff80;
            max-height: 200px;
            overflow-y: auto;
        }

        /* ì½”ë“œ í•˜ì´ë¼ì´íŒ… */
        .language-python .code-content {
            color: #f8f8f2;
        }

        .language-javascript .code-content,
        .language-js .code-content {
            color: #f8f8f2;
        }

        .language-java .code-content {
            color: #f8f8f2;
        }

        .language-cpp .code-content,
        .language-c .code-content {
            color: #f8f8f2;
        }

        .language-html .code-content {
            color: #f8f8f2;
        }

        .language-css .code-content {
            color: #f8f8f2;
        }

        /* ì…ë ¥ ì˜ì—­ */
        .input-container {
            padding: 2rem;
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.9), rgba(40, 20, 60, 0.8));
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 0, 128, 0.3);
            position: relative;
        }

        .input-wrapper {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .input-field {
            width: 100%;
            padding: 1.5rem 4rem 1.5rem 2rem;
            border: 2px solid rgba(255, 0, 128, 0.3);
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            color: #ffffff;
            font-size: 1.1rem;
            font-family: 'Rajdhani', sans-serif;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            border-color: #ff0080;
            box-shadow: 
                0 0 0 4px rgba(255, 0, 128, 0.1),
                0 0 20px rgba(255, 0, 128, 0.3);
            background: rgba(0, 0, 0, 0.5);
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-family: 'Rajdhani', sans-serif;
        }

        .send-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .send-button::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            transition: transform 0.3s ease;
            z-index: -1;
        }

        .send-button:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 0 25px rgba(255, 0, 128, 0.6);
        }

        .send-button:hover::before {
            transform: scale(1.2);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: translateY(-50%) scale(1);
        }

        /* íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° */
        .typing-indicator {
            display: none;
            margin-bottom: 2rem;
        }

        .typing-dots {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
        }

        .typing-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff0080, #00ffff);
            animation: typingPulse 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingPulse {
            0%, 60%, 100% { 
                opacity: 0.3; 
                transform: scale(1); 
            }
            30% { 
                opacity: 1; 
                transform: scale(1.3); 
            }
        }

        /* ìŠ¤í¬ë¡¤ë°” */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff0080, #8000ff);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #ff0080, #00ffff);
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid rgba(255, 0, 128, 0.3);
            }
            
            .chat-list {
                display: none;
            }
            
            .cinematic-title {
                font-size: 2.5rem;
            }
            
            .main-logo {
                width: 150px;
                height: 150px;
                font-size: 3rem;
            }
        }

        /* DeepSearch ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        #deepSearchBtn {
            position: absolute;
            left: 0;
            top: -48px;
            background: linear-gradient(45deg, #00ffff, #8000ff);
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1.2rem;
            font-weight: 700;
            cursor: pointer;
            z-index: 10;
            transition: box-shadow 0.2s, filter 0.2s, background 0.3s, border 0.3s;
            overflow: hidden;
            outline: none;
            box-shadow: 0 2px 10px rgba(0,255,255,0.15);
        }
        #deepSearchBtn.active {
            background: #181828;
            color: #fff;
            border: 2px solid #00ffff;
        }
        #deepSearchBtn .btn-wave {
            position: absolute;
            left: 0; top: 0; width: 100%; height: 100%;
            border-radius: 8px;
            pointer-events: none;
            z-index: 2;
            background: linear-gradient(90deg, rgba(0,255,255,0.12) 0%, rgba(128,0,255,0.18) 50%, rgba(0,0,0,0.35) 100%);
            animation: waveMove 1.2s linear forwards;
        }
        @keyframes waveMove {
            0% { transform: translateX(-100%); opacity: 0.7; }
            60% { opacity: 1; }
            100% { transform: translateX(100%); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ -->
    <div class="bg-animation"></div>
    <div class="particle-field" id="particleField"></div>

    <!-- ë¡œë”© ìŠ¤í¬ë¦° -->
    <div class="loading-screen" id="loadingScreen">
        <div class="cinematic-logo">
            <div class="main-logo">S</div>
        </div>
        <div class="cinematic-title">SOLCHI</div>
        <div class="cinematic-subtitle">Gaming AI Assistant</div>
    </div>

    <div class="main-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">S</div>
                <div class="sidebar-title">SOLCHI</div>
            </div>
            
            <!-- ì‚¬ìš©ì ì„¹ì…˜ -->
            <div class="user-section" id="userSection">
                <!-- ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœ -->
                <div id="guestUser" style="display: block;">
                    <button class="login-btn" id="loginBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        êµ¬ê¸€ë¡œ ë¡œê·¸ì¸
                    </button>
                </div>
                
                <!-- ë¡œê·¸ì¸í•œ ìƒíƒœ -->
                <div id="loggedInUser" style="display: none;">
                    <div class="user-profile">
                        <div class="user-avatar" id="userAvatar">
                            <span id="userInitial">U</span>
                        </div>
                        <div class="user-info">
                            <div class="user-name" id="userName">ì‚¬ìš©ì</div>
                            <div class="user-email" id="userEmail">user@example.com</div>
                        </div>
                    </div>
                    <button class="logout-btn" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </div>
            
            <button class="new-chat-btn" id="newChatBtn">
                <span>+ ìƒˆ ì±„íŒ…</span>
            </button>
            
            <div class="chat-list" id="chatList">
                <div class="chat-item active">
                    <div class="chat-title">ì²« ë²ˆì§¸ ì±„íŒ…</div>
                    <div class="chat-preview">ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” Solchiì…ë‹ˆë‹¤...</div>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ ì±„íŒ… ì˜ì—­ -->
        <div class="chat-main">
            <!-- í—¤ë” -->
            <div class="header">
                <h1>
                    <div class="header-logo">S</div>
                    SOLCHI GAMING AI
                </h1>
            </div>

            <!-- ì±„íŒ… ì»¨í…Œì´ë„ˆ -->
            <div class="chat-container" id="chatContainer">
                <div class="message assistant">
                    <div class="message-avatar">S</div>
                    <div class="message-content">
                        ğŸ® ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” Solchi, ì—¬ëŸ¬ë¶„ì˜ ê²Œì´ë° AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤! ê²Œì„ì— ê´€í•œ ì§ˆë¬¸ì´ë‚˜ ì¼ë°˜ì ì¸ ëŒ€í™” ëª¨ë‘ í™˜ì˜í•©ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?
                    </div>
                </div>
            </div>

            <!-- íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° -->
            <div class="typing-indicator" id="typingIndicator">
                <div class="message assistant">
                    <div class="message-avatar">S</div>
                    <div class="message-content">
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì…ë ¥ ì˜ì—­ -->
            <div class="input-container">
                <div class="input-wrapper">
                    <!-- DeepSearch ë²„íŠ¼ ì¶”ê°€ -->
                    <button id="deepSearchBtn" style="position:absolute; left:0; top:-48px; background:linear-gradient(45deg,#00ffff,#8000ff);color:#fff;border:none;border-radius:8px;padding:0.5rem 1.2rem;font-weight:700;cursor:pointer;z-index:2;transition:box-shadow 0.2s, filter 0.2s;">
                        ğŸ” DeepSearch
                    </button>
                    <input 
                        type="text" 
                        class="input-field" 
                        id="messageInput" 
                        placeholder="ê²Œì„ì— ëŒ€í•´ ë¬¼ì–´ë³´ê±°ë‚˜ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”..."
                        autocomplete="off"
                    >
                    <button class="send-button" id="sendButton">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22,2 15,22 11,13 2,9"></polygon>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let chatContainer;
        let messageInput;
        let sendButton;
        let typingIndicator;
        let chatList;
        let currentChatId = 1;
        let chats = {
            1: {
                id: 1,
                title: "ì²« ë²ˆì§¸ ì±„íŒ…",
                messages: [
                    {
                        content: "ğŸ® ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” Solchi, ì—¬ëŸ¬ë¶„ì˜ ê²Œì´ë° AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤! ê²Œì„ì— ê´€í•œ ì§ˆë¬¸ì´ë‚˜ ì¼ë°˜ì ì¸ ëŒ€í™” ëª¨ë‘ í™˜ì˜í•©ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?",
                        type: "assistant"
                    }
                ]
            }
        };

        // Hugging Face API ì„¤ì •
        const HUGGINGFACE_API_KEY = 'YOUR_API_KEY_HERE';
        const API_URL = 'https://api-inference.huggingface.co/models/microsoft/DialoGPT-medium';

        // ê²Œì´ë° í…Œë§ˆ ì‘ë‹µ íŒ¨í„´
        const gamingResponses = {
            greetings: [
                "ğŸ® ì•ˆë…•í•˜ì„¸ìš”, ê²Œì´ë¨¸! ì˜¤ëŠ˜ ì–´ë–¤ ê²Œì„ì„ í”Œë ˆì´í•˜ì…¨ë‚˜ìš”?",
                "ğŸ•¹ï¸ ë°˜ê°‘ìŠµë‹ˆë‹¤! ê²Œì„ì— ê´€í•œ ì§ˆë¬¸ì´ë‚˜ ì¼ë°˜ ëŒ€í™” ëª¨ë‘ í™˜ì˜í•´ìš”!",
                "âš¡ ì•ˆë…•í•˜ì„¸ìš”! Solchiì™€ í•¨ê»˜ ê²Œì´ë° ì„¸ê³„ë¥¼ íƒí—˜í•´ë´ìš”!"
            ],
            gaming: {
                "ê²Œì„": "ğŸ® ê²Œì„ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë´ìš”! ì–´ë–¤ ì¥ë¥´ë¥¼ ì¢‹ì•„í•˜ì‹œë‚˜ìš”? RPG, FPS, ì „ëµ ê²Œì„ ë“± ë‹¤ì–‘í•œ ê²Œì„ì— ëŒ€í•´ ëŒ€í™”í•  ìˆ˜ ìˆì–´ìš”!",
                "fps": "ğŸ”« FPS ê²Œì„ì„ ì¢‹ì•„í•˜ì‹œëŠ”êµ°ìš”! Counter-Strike, Valorant, Overwatch ê°™ì€ ê²Œì„ë“¤ì´ ì¸ê¸°ì£ . ì–´ë–¤ FPS ê²Œì„ì„ í”Œë ˆì´í•˜ì‹œë‚˜ìš”?",
                "rpg": "âš”ï¸ RPGëŠ” ì •ë§ ë§¤ë ¥ì ì¸ ì¥ë¥´ì£ ! ìºë¦­í„° ì„±ì¥ê³¼ ìŠ¤í† ë¦¬í…”ë§ì˜ ì¬ë¯¸ê°€ ìˆì–´ìš”. ìµœê·¼ì— í”Œë ˆì´í•œ RPGê°€ ìˆë‚˜ìš”?",
                "moba": "ğŸ† MOBA ê²Œì„ì€ ì „ëµê³¼ íŒ€ì›Œí¬ê°€ ì¤‘ìš”í•˜ì£ ! LoLì´ë‚˜ ë„íƒ€ ê°™ì€ ê²Œì„ì„ ì¦ê¸°ì‹œë‚˜ìš”?",
                "ìŠ¤íŒ€": "ğŸ’¨ Steamì€ ê²Œì´ë¨¸ë“¤ì˜ ì²œêµ­ì´ì£ ! í• ì¸ ê¸°ê°„ì—ëŠ” ì§€ê°‘ì´ ìœ„í—˜í•´ì ¸ìš”. ìµœê·¼ì— êµ¬ë§¤í•œ ê²Œì„ì´ ìˆë‚˜ìš”?",
                "ë‹Œí…ë„": "ğŸ¯ ë‹Œí…ë„ëŠ” ì–¸ì œë‚˜ ë…ì°½ì ì¸ ê²Œì„ë“¤ë¡œ ê°€ë“í•˜ì£ ! ë§ˆë¦¬ì˜¤, ì ¤ë‹¤, í¬ì¼“ëª¬... ì–´ë–¤ ê²Œì„ì´ ê°€ì¥ ê¸°ì–µì— ë‚¨ë‚˜ìš”?",
                "í”ŒìŠ¤": "ğŸ® PlayStationì˜ ë…ì ì‘ë“¤ì€ ì •ë§ í›Œë¥­í•˜ì£ ! ê°“ ì˜¤ë¸Œ ì›Œ, ë¼ìŠ¤íŠ¸ ì˜¤ë¸Œ ì–´ìŠ¤, ìŠ¤íŒŒì´ë”ë§¨... ì–´ë–¤ ê²Œì„ì„ ì¶”ì²œí•˜ì‹œê² ì–´ìš”?",
                "ì—‘ë°•": "ğŸ¯ Xbox Game PassëŠ” ì •ë§ í˜ì‹ ì ì¸ ì„œë¹„ìŠ¤ì˜ˆìš”! ìˆ˜ë§ì€ ê²Œì„ì„ ì›”ì •ì•¡ìœ¼ë¡œ ì¦ê¸¸ ìˆ˜ ìˆì£ .",
                "ëª¨ë°”ì¼": "ğŸ“± ëª¨ë°”ì¼ ê²Œì„ë„ ìš”ì¦˜ ì •ë§ í€„ë¦¬í‹°ê°€ ë†’ì•„ì¡Œì–´ìš”! ì–´ë–¤ ëª¨ë°”ì¼ ê²Œì„ì„ ì¦ê¸°ì‹œë‚˜ìš”?"
            },
            questions: {
                "ë­ì•¼": "ğŸ¤” ë¬´ì—‡ì— ëŒ€í•´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”? ê²Œì„ ê´€ë ¨ì´ë“  ì¼ë°˜ì ì¸ ì§ˆë¬¸ì´ë“  ìì„¸íˆ ì„¤ëª…í•´ì£¼ì‹œë©´ ë„ì›€ì„ ë“œë¦´ê²Œìš”!",
                "ëˆ„êµ¬ì•¼": "ğŸ® ì €ëŠ” Solchiì˜ˆìš”! ê²Œì´ë°ì„ ì‚¬ë‘í•˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤. ê²Œì„ ì¶”ì²œë¶€í„° ì¼ë°˜ ëŒ€í™”ê¹Œì§€ ëª¨ë“  ê²ƒì„ ë„ì™€ë“œë ¤ìš”!",
                "ë­ í•˜ëŠ” ê±°ì•¼": "âš¡ ì €ëŠ” ê²Œì´ë¨¸ë“¤ê³¼ ëŒ€í™”í•˜ê³  ê²Œì„ì— ê´€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” AIì…ë‹ˆë‹¤. ê²Œì„ ì¶”ì²œ, ê³µëµ, ë˜ëŠ” ê·¸ëƒ¥ ìˆ˜ë‹¤ë„ í™˜ì˜í•´ìš”!",
                "ì•ˆë…•": "ğŸ® ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ë„ ê²Œì„í•˜ëŠ” í•˜ë£¨ì˜€ë‚˜ìš”?",
                "ë°˜ê°€ì›Œ": "ğŸ•¹ï¸ ì €ë„ ë°˜ê°€ì›Œìš”! í•¨ê»˜ ê²Œì´ë° ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ë´ìš”!",
                "ê³ ë§ˆì›Œ": "â­ ë„ì›€ì´ ë˜ì–´ì„œ ê¸°ë»ìš”! ê²Œì„í•˜ë‹¤ê°€ ë§‰íˆëŠ” ë¶€ë¶„ì´ ìˆìœ¼ë©´ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”!",
                "ì¶”ì²œ": "ğŸ¯ ê²Œì„ ì¶”ì²œì„ ì›í•˜ì‹œëŠ”êµ°ìš”! ì–´ë–¤ ì¥ë¥´ë‚˜ í”Œë«í¼ì„ ì„ í˜¸í•˜ì‹œë‚˜ìš”? ë” êµ¬ì²´ì ìœ¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ì™„ë²½í•œ ì¶”ì²œì„ í•´ë“œë¦´ê²Œìš”!",
                "ê³µëµ": "ğŸ“– ê²Œì„ ê³µëµì´ í•„ìš”í•˜ì‹œêµ°ìš”! ì–´ë–¤ ê²Œì„ì˜ ì–´ë–¤ ë¶€ë¶„ì—ì„œ ë§‰íˆì…¨ë‚˜ìš”? ìµœëŒ€í•œ ë„ì›€ì„ ë“œë ¤ë³¼ê²Œìš”!"
            },
            fallback: [
                "ğŸ® í¥ë¯¸ë¡œìš´ ì§ˆë¬¸ì´ë„¤ìš”! ê²Œì„ê³¼ ê´€ë ¨ëœ ê²ƒì´ë¼ë©´ ë” ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”!",
                "âš¡ ê·¸ê²ƒì— ëŒ€í•´ ë” ì•Œì•„ë³¼ê²Œìš”! í˜¹ì‹œ ê²Œì„ê³¼ ì—°ê´€ëœ ë‚´ìš©ì¸ê°€ìš”?",
                "ğŸ•¹ï¸ ì¢‹ì€ ì§€ì ì´ì—ìš”! ê²Œì´ë¨¸ì˜ ê´€ì ì—ì„œ ìƒê°í•´ë³´ë©´...",
                "ğŸ¯ ì •ë§ ê¶ê¸ˆí•œ ë¶€ë¶„ì´ë„¤ìš”! ë” êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ ì£¼ì‹œë©´ ë² ìŠ¤íŠ¸ ë‹µë³€ì„ ë“œë¦´ê²Œìš”!"
            ]
        };

        // íŒŒí‹°í´ ìƒì„±
        function createParticles() {
            const particleField = document.getElementById('particleField');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particleField.appendChild(particle);
            }
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            setTimeout(() => {
                try {
                    document.getElementById('loadingScreen').classList.add('hidden');
                    initializeChat();
                } catch (e) {
                    // ë¡œë”© ìŠ¤í¬ë¦°ì€ ë¬´ì¡°ê±´ ìˆ¨ê¹€
                    const loadingScreen = document.getElementById('loadingScreen');
                    if (loadingScreen) loadingScreen.classList.add('hidden');
                    // ì½˜ì†”ì— ì—ëŸ¬ ì¶œë ¥
                    console.error('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜:', e);
                    alert('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í•´ë³´ì„¸ìš”.');
                }
            }, 4000);
        });

        function initializeChat() {
            chatContainer = document.getElementById('chatContainer');
            messageInput = document.getElementById('messageInput');
            sendButton = document.getElementById('sendButton');
            typingIndicator = document.getElementById('typingIndicator');
            chatList = document.getElementById('chatList');

            // í•„ìˆ˜ ìš”ì†Œ ì²´í¬
            if (!chatContainer || !messageInput || !sendButton) {
                throw new Error('í•„ìˆ˜ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            document.getElementById('newChatBtn').addEventListener('click', createNewChat);
            
            messageInput.focus();
            loadChat(currentChatId);

            const deepSearchBtn = document.getElementById('deepSearchBtn');
            let deepSearchActive = false;

            deepSearchBtn.addEventListener('click', function() {
                if (!deepSearchActive) {
                    deepSearchBtn.classList.add('active');
                    showBtnWave();
                    deepSearchActive = true;

                    const query = messageInput.value.trim();
                    if (!query) {
                        messageInput.focus();
                        return;
                    }
                    addMessageToUI('ğŸ” DeepSearch: ' + query, 'user');
                    showTypingIndicator();
                    sendButton.disabled = true;
                    fetch(API_BASE_URL + '/search-chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            message: '[deepsearch] ' + query,
                            chat_id: currentChatId
                        })
                    }).then(async response => {
                        let aiResponse;
                        if (response.ok) {
                            const data = await response.json();
                            aiResponse = data.response || getRandomGamingFallback();
                        } else {
                            aiResponse = getRandomGamingFallback();
                        }
                        hideTypingIndicator();
                        chats[currentChatId].messages.push({
                            content: aiResponse,
                            type: "assistant"
                        });
                        addMessageToUI(aiResponse, 'assistant');
                        sendButton.disabled = false;
                        messageInput.focus();
                        deepSearchBtn.classList.remove('active');
                        hideBtnWave();
                        deepSearchActive = false;
                    }).catch(() => {
                        hideTypingIndicator();
                        sendButton.disabled = false;
                        deepSearchBtn.classList.remove('active');
                        hideBtnWave();
                        deepSearchActive = false;
                    });
                } else {
                    // ë¹„í™œì„±í™”(í† ê¸€)
                    deepSearchBtn.classList.remove('active');
                    hideBtnWave();
                    deepSearchActive = false;
                }
            });

            // ë²„íŠ¼ wave ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜
            function showBtnWave() {
                hideBtnWave(); // ì¤‘ë³µ ë°©ì§€
                const wave = document.createElement('div');
                wave.className = 'btn-wave';
                deepSearchBtn.appendChild(wave);
                // wave ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚˜ë©´ ìë™ ì œê±° (1.2s)
                setTimeout(() => {
                    if (wave.parentNode) wave.parentNode.removeChild(wave);
                }, 1200);
            }
            function hideBtnWave() {
                const wave = deepSearchBtn.querySelector('.btn-wave');
                if (wave) wave.parentNode.removeChild(wave);
            }
        }

        function createNewChat() {
            const newChatId = Date.now();
            const chatTitle = `ì±„íŒ… ${Object.keys(chats).length + 1}`;
            
            chats[newChatId] = {
                id: newChatId,
                title: chatTitle,
                messages: [
                    {
                        content: "ğŸ® ìƒˆë¡œìš´ ì±„íŒ…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?",
                        type: "assistant"
                    }
                ]
            };

            addChatToList(newChatId, chatTitle, "ìƒˆë¡œìš´ ì±„íŒ…ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤!");
            switchToChat(newChatId);
        }

        function addChatToList(chatId, title, preview) {
            const chatItem = document.createElement('div');
            chatItem.className = 'chat-item';
            chatItem.setAttribute('data-chat-id', chatId);
            chatItem.innerHTML = `
                <div class="chat-title">${title}</div>
                <div class="chat-preview">${preview}</div>
            `;
            
            chatItem.addEventListener('click', () => switchToChat(chatId));
            chatList.appendChild(chatItem);
        }

        function switchToChat(chatId) {
            // í˜„ì¬ í™œì„± ì±„íŒ… í‘œì‹œ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-chat-id') == chatId) {
                    item.classList.add('active');
                }
            });

            currentChatId = chatId;
            loadChat(chatId);
        }

        function loadChat(chatId) {
            const chat = chats[chatId];
            if (!chat) return;

            // ì±„íŒ… ì»¨í…Œì´ë„ˆ í´ë¦¬ì–´
            chatContainer.innerHTML = '';

            // ë©”ì‹œì§€ ë¡œë“œ
            chat.messages.forEach(message => {
                addMessageToUI(message.content, message.type);
            });
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // í˜„ì¬ ì±„íŒ…ì— ë©”ì‹œì§€ ì¶”ê°€
            chats[currentChatId].messages.push({
                content: message,
                type: "user"
            });

            // UIì— ë©”ì‹œì§€ ì¶”ê°€
            addMessageToUI(message, 'user');
            messageInput.value = '';
            sendButton.disabled = true;

            // ì±„íŒ… ëª©ë¡ ì—…ë°ì´íŠ¸
            updateChatPreview(currentChatId, message);

            // íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° í‘œì‹œ
            showTypingIndicator();

            try {
                // ì‹¤ì œ ë°±ì—”ë“œ API í˜¸ì¶œ
                const response = await fetch(API_BASE_URL + '/search-chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        chat_id: currentChatId
                    })
                });
                let aiResponse;
                if (response.ok) {
                    const data = await response.json();
                    aiResponse = data.response || getRandomGamingFallback();
                } else {
                    aiResponse = getRandomGamingFallback();
                }
                hideTypingIndicator();

                // ì‘ë‹µì„ ì±„íŒ…ê³¼ UIì— ì¶”ê°€
                chats[currentChatId].messages.push({
                    content: aiResponse,
                    type: "assistant"
                });
                addMessageToUI(aiResponse, 'assistant');

                // ì±„íŒ… ì œëª© ì—…ë°ì´íŠ¸ (ì²« ë²ˆì§¸ ë©”ì‹œì§€ì¸ ê²½ìš°)
                if (chats[currentChatId].messages.length === 3) {
                    updateChatTitle(currentChatId, message);
                }

                // ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë¼ë©´ ì„œë²„ì— ì±„íŒ… ì €ì¥
                const userResponse = await fetch('/api/user');
                const userData = await userResponse.json();
                if (userData.authenticated) {
                    saveChatToServer(currentChatId, chats[currentChatId].messages);
                }

            } catch (error) {
                hideTypingIndicator();
                const fallbackResponse = getRandomGamingFallback();
                chats[currentChatId].messages.push({
                    content: fallbackResponse,
                    type: "assistant"
                });
                addMessageToUI(fallbackResponse, 'assistant');
            }

            sendButton.disabled = false;
            messageInput.focus();
        }

        function addMessageToUI(content, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = type === 'user' ? 'U' : 'S';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            // ì¤„ë°”ê¿ˆì´ <br>ë¡œ ë“¤ì–´ì˜¤ë¯€ë¡œ innerHTML ì‚¬ìš©
            messageContent.innerHTML = content;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function updateChatPreview(chatId, message) {
            const chatItem = document.querySelector(`[data-chat-id="${chatId}"]`);
            if (chatItem) {
                const preview = chatItem.querySelector('.chat-preview');
                preview.textContent = message.length > 30 ? message.substring(0, 30) + '...' : message;
            }
        }

        function updateChatTitle(chatId, firstMessage) {
            const title = firstMessage.length > 20 ? firstMessage.substring(0, 20) + '...' : firstMessage;
            chats[chatId].title = title;
            
            const chatItem = document.querySelector(`[data-chat-id="${chatId}"]`);
            if (chatItem) {
                const titleElement = chatItem.querySelector('.chat-title');
                titleElement.textContent = title;
            }
        }

        function showTypingIndicator() {
            typingIndicator.style.display = 'block';
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        async function generateGamingResponse(message) {
            // ë¨¼ì € ê²Œì´ë° í…Œë§ˆ ì‘ë‹µ ì²´í¬
            const gamingResponse = getGamingResponse(message);
            if (gamingResponse !== null) {
                return gamingResponse;
            }

            // Hugging Face API í˜¸ì¶œ (ì‹¤ì œ API í‚¤ê°€ ìˆì„ ë•Œë§Œ)
            if (HUGGINGFACE_API_KEY !== 'YOUR_API_KEY_HERE') {
                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${HUGGINGFACE_API_KEY}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            inputs: message,
                            parameters: {
                                max_length: 100,
                                temperature: 0.7,
                                do_sample: true
                            }
                        }),
                    });

                    if (response.ok) {
                        const data = await response.json();
                        return data[0]?.generated_text || getRandomGamingFallback();
                    }
                } catch (error) {
                    console.error('API Error:', error);
                }
            }

            return getRandomGamingFallback();
        }

        function getGamingResponse(message) {
            const lowerMessage = message.toLowerCase().trim();
            
            // ì¸ì‚¬ë§ ì²´í¬
            if (lowerMessage.includes('ì•ˆë…•') || lowerMessage.includes('ë°˜ê°€') || lowerMessage.includes('hello')) {
                return getRandomFromArray(gamingResponses.greetings);
            }
            
            // ê²Œì´ë° í‚¤ì›Œë“œ ì²´í¬
            for (const [key, response] of Object.entries(gamingResponses.gaming)) {
                if (lowerMessage.includes(key)) {
                    return response;
                }
            }
            
            // ê¸°ë³¸ ì§ˆë¬¸ ì²´í¬
            for (const [key, response] of Object.entries(gamingResponses.questions)) {
                if (lowerMessage.includes(key) || lowerMessage.endsWith(key)) {
                    return response;
                }
            }
            
            // "ê°€ ë­ì•¼?" íŒ¨í„´ ì²´í¬
            const whatPattern = /(.+)\s*ê°€?\s*ë­ì•¼\??$/;
            const match = lowerMessage.match(whatPattern);
            if (match) {
                const subject = match[1].trim();
                if (subject.includes('ê²Œì„') || subject.includes('fps') || subject.includes('rpg')) {
                    return `ğŸ® ${subject}ì— ëŒ€í•´ ê¶ê¸ˆí•˜ì‹œêµ°ìš”! ${subject}ëŠ” ê²Œì´ë° ì„¸ê³„ì—ì„œ ì •ë§ ì¤‘ìš”í•œ ìš”ì†Œì£ . ë” êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ë¶€ë¶„ì´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”?`;
                }
                return `ğŸ¤” ${subject}ì— ëŒ€í•´ ê¶ê¸ˆí•˜ì‹œêµ°ìš”! ${subject}ëŠ” ë‹¤ì–‘í•œ ì˜ë¯¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš”. ê²Œì„ê³¼ ê´€ë ¨ëœ ë‚´ìš©ì´ë¼ë©´ ë” ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”!`;
            }
            
            return null;
        }

        function getRandomGamingFallback() {
            return getRandomFromArray(gamingResponses.fallback);
        }

        function getRandomFromArray(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤ ì„¤ì •
        window.addEventListener('load', function() {
            loadChatHistory();
            checkUserAuth();
            setTimeout(() => {
                if (messageInput) {
                    messageInput.focus();
                }
            }, 4500);
        });

        // ì‚¬ìš©ì ì¸ì¦ ìƒíƒœ í™•ì¸
        async function checkUserAuth() {
            try {
                const response = await fetch('/api/user');
                const data = await response.json();
                
                if (data.authenticated) {
                    showLoggedInUser(data.user);
                    loadUserChats();
                } else {
                    showGuestUser();
                }
            } catch (error) {
                console.error('ì¸ì¦ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                showGuestUser();
            }
        }

        // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì UI í‘œì‹œ
        function showLoggedInUser(user) {
            document.getElementById('guestUser').style.display = 'none';
            document.getElementById('loggedInUser').style.display = 'block';
            
            // ì‚¬ìš©ì ì •ë³´ ì„¤ì •
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userEmail').textContent = user.email;
            
            if (user.picture) {
                const avatar = document.getElementById('userAvatar');
                avatar.innerHTML = `<img src="${user.picture}" alt="${user.name}">`;
            } else {
                document.getElementById('userInitial').textContent = user.name.charAt(0).toUpperCase();
            }
        }

        // ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì UI í‘œì‹œ
        function showGuestUser() {
            document.getElementById('guestUser').style.display = 'block';
            document.getElementById('loggedInUser').style.display = 'none';
        }

        // ì‚¬ìš©ì ì±„íŒ… íˆìŠ¤í† ë¦¬ ë¡œë“œ
        async function loadUserChats() {
            try {
                const response = await fetch('/api/chats');
                const data = await response.json();
                
                if (data.chats && data.chats.length > 0) {
                    // ì„œë²„ì˜ ì±„íŒ… íˆìŠ¤í† ë¦¬ë¡œ ë¡œì»¬ ì±„íŒ… ë®ì–´ì“°ê¸°
                    chats = {};
                    data.chats.forEach(chat => {
                        chats[chat.id] = {
                            id: chat.id,
                            title: chat.messages[0]?.content?.substring(0, 20) + '...' || 'ìƒˆ ì±„íŒ…',
                            messages: chat.messages
                        };
                    });
                    
                    updateChatList();
                    
                    // ì²« ë²ˆì§¸ ì±„íŒ… ë¡œë“œ
                    const firstChatId = Object.keys(chats)[0];
                    if (firstChatId) {
                        currentChatId = firstChatId;
                        loadChat(firstChatId);
                    }
                }
            } catch (error) {
                console.error('ì‚¬ìš©ì ì±„íŒ… ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ì±„íŒ… ì €ì¥ (ë¡œê·¸ì¸í•œ ì‚¬ìš©ììš©)
        async function saveChatToServer(chatId, messages) {
            try {
                await fetch('/api/save-chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        chatId: chatId,
                        messages: messages
                    })
                });
            } catch (error) {
                console.error('ì±„íŒ… ì €ì¥ ì‹¤íŒ¨:', error);
            }
        }

        // ë¡œê·¸ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('loginBtn').addEventListener('click', function() {
            window.location.href = '/auth/google';
        });

        // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('logoutBtn').addEventListener('click', function() {
            window.location.href = '/auth/logout';
        });
    </script>
</body>
</html>